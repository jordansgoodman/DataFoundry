- name: Create data directories
  file:
    path: "{{ item }}"
    state: directory
    mode: '0755'
  loop:
    - "{{ playbook_dir }}/../data"
    - "{{ playbook_dir }}/../data/postgres"
    - "{{ playbook_dir }}/../data/redis"
    - "{{ playbook_dir }}/../data/superset"
    - "{{ playbook_dir }}/../data/airflow"
    - "{{ playbook_dir }}/../data/logging"
    - "{{ playbook_dir }}/../data/logging/loki"
    - "{{ playbook_dir }}/../data/logging/promtail"
    - "{{ playbook_dir }}/../data/logging/grafana"
    - "{{ playbook_dir }}/../data/metrics"
    - "{{ playbook_dir }}/../data/metrics/prometheus"

- name: Compose up
  command: docker compose -f {{ playbook_dir }}/../docker-compose.yml up -d
  args:
    chdir: "{{ playbook_dir }}/.."
